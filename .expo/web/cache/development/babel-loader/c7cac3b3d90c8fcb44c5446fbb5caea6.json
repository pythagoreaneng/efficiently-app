{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/objectWithoutProperties\";\nimport _extends from \"@babel/runtime/helpers/extends\";\nimport _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nimport _assertThisInitialized from \"@babel/runtime/helpers/assertThisInitialized\";\nimport _inherits from \"@babel/runtime/helpers/inherits\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/getPrototypeOf\";\nvar _excluded = [\"style\", \"hideKnob\", \"horizontal\", \"allowShadow\", \"theme\"];\nvar _jsxFileName = \"/Users/kw/LocalDev/efficiently-app/node_modules/react-native-calendars/src/expandableCalendar/index.js\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) { symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); } keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\n\nimport _ from 'lodash';\nimport PropTypes from 'prop-types';\nimport memoize from 'memoize-one';\nimport XDate from 'xdate';\nimport React, { Component } from 'react';\nimport AccessibilityInfo from \"react-native-web/dist/exports/AccessibilityInfo\";\nimport PanResponder from \"react-native-web/dist/exports/PanResponder\";\nimport Animated from \"react-native-web/dist/exports/Animated\";\nimport View from \"react-native-web/dist/exports/View\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport Image from \"react-native-web/dist/exports/Image\";\nimport { CALENDAR_KNOB } from \"../testIDs\";\nimport dateutils from \"../dateutils\";\nimport { parseDate, toMarkingFormat } from \"../interface\";\nimport styleConstructor, { HEADER_HEIGHT } from \"./style\";\nimport CalendarList from \"../calendar-list\";\nimport Calendar from \"../calendar\";\nimport asCalendarConsumer from \"./asCalendarConsumer\";\nimport WeekCalendar from \"./WeekCalendar\";\nimport Week from \"./week\";\n\nvar commons = require(\"./commons\");\n\nvar UPDATE_SOURCES = commons.UPDATE_SOURCES;\nvar POSITIONS = {\n  CLOSED: 'closed',\n  OPEN: 'open'\n};\nvar SPEED = 20;\nvar BOUNCINESS = 6;\nvar CLOSED_HEIGHT = 120;\nvar WEEK_HEIGHT = 46;\nvar KNOB_CONTAINER_HEIGHT = 20;\nvar DAY_NAMES_PADDING = 24;\nvar PAN_GESTURE_THRESHOLD = 30;\n\nvar ExpandableCalendar = function (_Component) {\n  _inherits(ExpandableCalendar, _Component);\n\n  var _super = _createSuper(ExpandableCalendar);\n\n  function ExpandableCalendar(props) {\n    var _this;\n\n    _classCallCheck(this, ExpandableCalendar);\n\n    _this = _super.call(this, props);\n\n    _this.handleScreenReaderStatus = function (screenReaderEnabled) {\n      _this.setState({\n        screenReaderEnabled: screenReaderEnabled\n      });\n    };\n\n    _this.handleMoveShouldSetPanResponder = function (e, gestureState) {\n      if (_this.props.disablePan) {\n        return false;\n      }\n\n      if (!_this.props.horizontal && _this.state.position === POSITIONS.OPEN) {\n        return false;\n      }\n\n      if (_this.state.position === POSITIONS.CLOSED && gestureState.dy < 0) {\n        return false;\n      }\n\n      return gestureState.dy > 5 || gestureState.dy < -5;\n    };\n\n    _this.handlePanResponderGrant = function () {};\n\n    _this.handlePanResponderMove = function (e, gestureState) {\n      _this._wrapperStyles.style.height = Math.max(_this.closedHeight, _this._height + gestureState.dy);\n\n      if (!_this.props.horizontal) {\n        _this._headerStyles.style.top = Math.min(Math.max(-gestureState.dy, -HEADER_HEIGHT), 0);\n      } else {\n        if (_this.state.position === POSITIONS.CLOSED) {\n          _this._weekCalendarStyles.style.opacity = Math.min(1, Math.max(1 - gestureState.dy / 100, 0));\n        }\n      }\n\n      _this.updateNativeStyles();\n    };\n\n    _this.handlePanResponderEnd = function () {\n      _this._height = _this._wrapperStyles.style.height;\n\n      _this.bounceToPosition();\n    };\n\n    _this.onAnimatedFinished = function (_ref) {\n      var finished = _ref.finished;\n\n      if (finished) {}\n    };\n\n    _this.onPressArrowLeft = function () {\n      _.invoke(_this.props, 'onPressArrowLeft');\n\n      _this.scrollPage(false);\n    };\n\n    _this.onPressArrowRight = function () {\n      _.invoke(_this.props, 'onPressArrowRight');\n\n      _this.scrollPage(true);\n    };\n\n    _this.onDayPress = function (value) {\n      _.invoke(_this.props.context, 'setDate', value.dateString, UPDATE_SOURCES.DAY_PRESS);\n\n      setTimeout(function () {\n        if (_this.state.position === POSITIONS.OPEN) {\n          _this.bounceToPosition(_this.closedHeight);\n        }\n      }, 0);\n    };\n\n    _this.onVisibleMonthsChange = function (value) {\n      if (_this.visibleMonth !== _.first(value).month) {\n        _this.visibleMonth = _.first(value).month;\n        var _this$props$context = _this.props.context,\n            date = _this$props$context.date,\n            updateSource = _this$props$context.updateSource;\n\n        if (_this.visibleMonth !== _this.getMonth(date) && updateSource !== UPDATE_SOURCES.DAY_PRESS) {\n          var next = _this.isLaterDate(_.first(value), date);\n\n          _this.scrollPage(next);\n        }\n\n        setTimeout(function () {\n          var numberOfWeeks = _this.getNumberOfWeeksInMonth(parseDate(_this.props.context.date));\n\n          if (numberOfWeeks !== _this.numberOfWeeks) {\n            _this.numberOfWeeks = numberOfWeeks;\n            _this.openHeight = _this.getOpenHeight();\n\n            if (_this.state.position === POSITIONS.OPEN) {\n              _this.bounceToPosition(_this.openHeight);\n            }\n          }\n        }, 0);\n      }\n    };\n\n    _this.getWeekDaysStyle = memoize(function (calendarStyle) {\n      return [_this.style.weekDayNames, {\n        paddingLeft: (calendarStyle == null ? void 0 : calendarStyle.paddingLeft) + 6 || DAY_NAMES_PADDING,\n        paddingRight: (calendarStyle == null ? void 0 : calendarStyle.paddingRight) + 6 || DAY_NAMES_PADDING\n      }];\n    });\n    _this.renderWeekDaysNames = memoize(function (weekDaysNames, calendarStyle) {\n      return React.createElement(View, {\n        style: _this.getWeekDaysStyle(calendarStyle),\n        __self: _assertThisInitialized(_this),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 397,\n          columnNumber: 7\n        }\n      }, weekDaysNames.map(function (day, index) {\n        return React.createElement(Text, {\n          allowFontScaling: false,\n          key: day + index,\n          style: _this.style.weekday,\n          numberOfLines: 1,\n          __self: _assertThisInitialized(_this),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 399,\n            columnNumber: 11\n          }\n        }, day);\n      }));\n    });\n\n    _this.renderArrow = function (direction) {\n      if (_.isFunction(_this.props.renderArrow)) {\n        return _this.props.renderArrow(direction);\n      }\n\n      return React.createElement(Image, {\n        source: direction === 'right' ? _this.props.rightArrowImageSource : _this.props.leftArrowImageSource,\n        style: _this.style.arrowImage,\n        testID: _this.props.testID + \"-\" + direction + \"-arrow\",\n        __self: _assertThisInitialized(_this),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 465,\n          columnNumber: 7\n        }\n      });\n    };\n\n    _this.style = styleConstructor(props.theme);\n    _this.closedHeight = CLOSED_HEIGHT + (props.hideKnob ? 0 : KNOB_CONTAINER_HEIGHT);\n    _this.numberOfWeeks = _this.getNumberOfWeeksInMonth(XDate(_this.props.context.date));\n    _this.openHeight = _this.getOpenHeight();\n    var startHeight = props.initialPosition === POSITIONS.CLOSED ? _this.closedHeight : _this.openHeight;\n    _this._height = startHeight;\n    _this._wrapperStyles = {\n      style: {\n        height: startHeight\n      }\n    };\n    _this._headerStyles = {\n      style: {\n        top: props.initialPosition === POSITIONS.CLOSED ? 0 : -HEADER_HEIGHT\n      }\n    };\n    _this._weekCalendarStyles = {\n      style: {}\n    };\n    _this.wrapper = undefined;\n    _this.calendar = undefined;\n    _this.visibleMonth = _this.getMonth(_this.props.context.date);\n    _this.initialDate = props.context.date;\n    _this.headerStyleOverride = {\n      'stylesheet.calendar.header': {\n        week: {\n          marginTop: 7,\n          marginBottom: -4,\n          flexDirection: 'row',\n          justifyContent: 'space-around'\n        }\n      }\n    };\n    _this.state = {\n      deltaY: new Animated.Value(startHeight),\n      headerDeltaY: new Animated.Value(props.initialPosition === POSITIONS.CLOSED ? 0 : -HEADER_HEIGHT),\n      position: props.initialPosition,\n      screenReaderEnabled: false\n    };\n    _this.panResponder = PanResponder.create({\n      onMoveShouldSetPanResponder: _this.handleMoveShouldSetPanResponder,\n      onPanResponderGrant: _this.handlePanResponderGrant,\n      onPanResponderMove: _this.handlePanResponderMove,\n      onPanResponderRelease: _this.handlePanResponderEnd,\n      onPanResponderTerminate: _this.handlePanResponderEnd\n    });\n    return _this;\n  }\n\n  _createClass(ExpandableCalendar, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      if (AccessibilityInfo) {\n        if (AccessibilityInfo.isScreenReaderEnabled) {\n          AccessibilityInfo.isScreenReaderEnabled().then(this.handleScreenReaderStatus);\n        } else if (AccessibilityInfo.fetch) {\n          AccessibilityInfo.fetch().then(this.handleScreenReaderStatus);\n        }\n      }\n    }\n  }, {\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate(prevProps) {\n      var date = this.props.context.date;\n\n      if (date !== prevProps.context.date) {\n        this.scrollToDate(date);\n      }\n    }\n  }, {\n    key: \"updateNativeStyles\",\n    value: function updateNativeStyles() {\n      var _this$wrapper;\n\n      (_this$wrapper = this.wrapper) == null ? void 0 : _this$wrapper.setNativeProps(this._wrapperStyles);\n\n      if (!this.props.horizontal) {\n        this.header && this.header.setNativeProps(this._headerStyles);\n      } else {\n        this.weekCalendar && this.weekCalendar.setNativeProps(this._weekCalendarStyles);\n      }\n    }\n  }, {\n    key: \"scrollToDate\",\n    value: function scrollToDate(date) {\n      if (this.calendar) {\n        if (!this.props.horizontal) {\n          this.calendar.scrollToDay(XDate(date), 0, true);\n        } else if (this.getMonth(date) !== this.visibleMonth) {\n          this.calendar.scrollToMonth(XDate(date));\n        }\n      }\n    }\n  }, {\n    key: \"scrollPage\",\n    value: function scrollPage(next) {\n      if (this.props.horizontal) {\n        var d = parseDate(this.props.context.date);\n\n        if (this.state.position === POSITIONS.OPEN) {\n          d.setDate(1);\n          d.addMonths(next ? 1 : -1);\n        } else {\n          var firstDay = this.props.firstDay;\n          var dayOfTheWeek = d.getDay();\n\n          if (dayOfTheWeek < firstDay && firstDay > 0) {\n            dayOfTheWeek = 7 + dayOfTheWeek;\n          }\n\n          var firstDayOfWeek = (next ? 7 : -7) - dayOfTheWeek + firstDay;\n          d.addDays(firstDayOfWeek);\n        }\n\n        _.invoke(this.props.context, 'setDate', toMarkingFormat(d), UPDATE_SOURCES.PAGE_SCROLL);\n      }\n    }\n  }, {\n    key: \"getOpenHeight\",\n    value: function getOpenHeight() {\n      if (!this.props.horizontal) {\n        return Math.max(commons.screenHeight, commons.screenWidth);\n      }\n\n      return CLOSED_HEIGHT + WEEK_HEIGHT * (this.numberOfWeeks - 1) + (this.props.hideKnob ? 12 : KNOB_CONTAINER_HEIGHT);\n    }\n  }, {\n    key: \"getYear\",\n    value: function getYear(date) {\n      var d = XDate(date);\n      return d.getFullYear();\n    }\n  }, {\n    key: \"getMonth\",\n    value: function getMonth(date) {\n      var d = XDate(date);\n      return d.getMonth() + 1;\n    }\n  }, {\n    key: \"getNumberOfWeeksInMonth\",\n    value: function getNumberOfWeeksInMonth(month) {\n      var days = dateutils.page(month, this.props.firstDay);\n      return days.length / 7;\n    }\n  }, {\n    key: \"shouldHideArrows\",\n    value: function shouldHideArrows() {\n      if (!this.props.horizontal) {\n        return true;\n      }\n\n      return this.props.hideArrows || false;\n    }\n  }, {\n    key: \"isLaterDate\",\n    value: function isLaterDate(date1, date2) {\n      if (date1.year > this.getYear(date2)) {\n        return true;\n      }\n\n      if (date1.year === this.getYear(date2)) {\n        if (date1.month > this.getMonth(date2)) {\n          return true;\n        }\n      }\n\n      return false;\n    }\n  }, {\n    key: \"bounceToPosition\",\n    value: function bounceToPosition(toValue) {\n      if (!this.props.disablePan) {\n        var _this$state = this.state,\n            deltaY = _this$state.deltaY,\n            position = _this$state.position;\n        var _this$props = this.props,\n            openThreshold = _this$props.openThreshold,\n            closeThreshold = _this$props.closeThreshold;\n        var threshold = position === POSITIONS.OPEN ? this.openHeight - closeThreshold : this.closedHeight + openThreshold;\n        var isOpen = this._height >= threshold;\n        var newValue = isOpen ? this.openHeight : this.closedHeight;\n        deltaY.setValue(this._height);\n        this._height = toValue || newValue;\n        isOpen = this._height >= threshold;\n        Animated.spring(deltaY, {\n          toValue: this._height,\n          speed: SPEED,\n          bounciness: BOUNCINESS,\n          useNativeDriver: false\n        }).start(this.onAnimatedFinished);\n\n        _.invoke(this.props, 'onCalendarToggled', isOpen);\n\n        this.setPosition();\n        this.closeHeader(isOpen);\n        this.resetWeekCalendarOpacity(isOpen);\n      }\n    }\n  }, {\n    key: \"setPosition\",\n    value: function setPosition() {\n      var isClosed = this._height === this.closedHeight;\n      this.setState({\n        position: isClosed ? POSITIONS.CLOSED : POSITIONS.OPEN\n      });\n    }\n  }, {\n    key: \"resetWeekCalendarOpacity\",\n    value: function resetWeekCalendarOpacity(isOpen) {\n      this._weekCalendarStyles.style.opacity = isOpen ? 0 : 1;\n      this.updateNativeStyles();\n    }\n  }, {\n    key: \"closeHeader\",\n    value: function closeHeader(isOpen) {\n      var headerDeltaY = this.state.headerDeltaY;\n      headerDeltaY.setValue(this._headerStyles.style.top);\n\n      if (!this.props.horizontal && !isOpen) {\n        Animated.spring(headerDeltaY, {\n          toValue: 0,\n          speed: SPEED / 10,\n          bounciness: 1,\n          useNativeDriver: false\n        }).start();\n      }\n    }\n  }, {\n    key: \"renderHeader\",\n    value: function renderHeader() {\n      var _this2 = this;\n\n      var monthYear = XDate(this.props.context.date).toString('MMMM yyyy');\n      var weekDaysNames = dateutils.weekDayNames(this.props.firstDay);\n      return React.createElement(Animated.View, {\n        ref: function ref(e) {\n          return _this2.header = e;\n        },\n        style: [this.style.header, {\n          height: HEADER_HEIGHT,\n          top: this.state.headerDeltaY\n        }],\n        pointerEvents: 'none',\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 412,\n          columnNumber: 7\n        }\n      }, React.createElement(Text, {\n        allowFontScaling: false,\n        style: this.style.headerTitle,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 417,\n          columnNumber: 9\n        }\n      }, monthYear), this.renderWeekDaysNames(weekDaysNames, this.props.calendarStyle));\n    }\n  }, {\n    key: \"renderWeekCalendar\",\n    value: function renderWeekCalendar() {\n      var _this3 = this;\n\n      var position = this.state.position;\n      var disableWeekScroll = this.props.disableWeekScroll;\n      var WeekComponent = disableWeekScroll ? Week : WeekCalendar;\n      return React.createElement(Animated.View, {\n        ref: function ref(e) {\n          return _this3.weekCalendar = e;\n        },\n        style: [this.style.weekContainer, position === POSITIONS.OPEN ? this.style.hidden : this.style.visible],\n        pointerEvents: position === POSITIONS.CLOSED ? 'auto' : 'none',\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 431,\n          columnNumber: 7\n        }\n      }, React.createElement(WeekComponent, _extends({}, this.props, {\n        current: this.props.context.date,\n        onDayPress: this.onDayPress,\n        style: this.props.calendarStyle,\n        allowShadow: false,\n        hideDayNames: true,\n        accessibilityElementsHidden: true,\n        importantForAccessibility: 'no-hide-descendants',\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 436,\n          columnNumber: 9\n        }\n      })));\n    }\n  }, {\n    key: \"renderKnob\",\n    value: function renderKnob() {\n      return React.createElement(View, {\n        style: this.style.knobContainer,\n        pointerEvents: 'none',\n        testID: this.props.testID + \"-knob\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 453,\n          columnNumber: 7\n        }\n      }, React.createElement(View, {\n        style: this.style.knob,\n        testID: CALENDAR_KNOB,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 454,\n          columnNumber: 9\n        }\n      }));\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this4 = this;\n\n      var _this$props2 = this.props,\n          style = _this$props2.style,\n          hideKnob = _this$props2.hideKnob,\n          horizontal = _this$props2.horizontal,\n          allowShadow = _this$props2.allowShadow,\n          theme = _this$props2.theme,\n          others = _objectWithoutProperties(_this$props2, _excluded);\n\n      var _this$state2 = this.state,\n          deltaY = _this$state2.deltaY,\n          position = _this$state2.position,\n          screenReaderEnabled = _this$state2.screenReaderEnabled;\n      var isOpen = position === POSITIONS.OPEN;\n\n      var themeObject = _extends(this.headerStyleOverride, theme);\n\n      return React.createElement(View, {\n        testID: this.props.testID,\n        style: [allowShadow && this.style.containerShadow, style],\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 480,\n          columnNumber: 7\n        }\n      }, screenReaderEnabled ? React.createElement(Calendar, _extends({\n        testID: \"calendar\"\n      }, others, {\n        theme: themeObject,\n        onDayPress: this.onDayPress,\n        hideExtraDays: true,\n        renderArrow: this.renderArrow,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 482,\n          columnNumber: 11\n        }\n      })) : React.createElement(Animated.View, _extends({\n        ref: function ref(e) {\n          return _this4.wrapper = e;\n        },\n        style: {\n          height: deltaY\n        }\n      }, this.panResponder.panHandlers, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 491,\n          columnNumber: 11\n        }\n      }), React.createElement(CalendarList, _extends({\n        testID: \"calendar\",\n        horizontal: horizontal\n      }, others, {\n        theme: themeObject,\n        ref: function ref(r) {\n          return _this4.calendar = r;\n        },\n        current: this.initialDate,\n        onDayPress: this.onDayPress,\n        onVisibleMonthsChange: this.onVisibleMonthsChange,\n        pagingEnabled: true,\n        scrollEnabled: isOpen,\n        hideArrows: this.shouldHideArrows(),\n        onPressArrowLeft: this.onPressArrowLeft,\n        onPressArrowRight: this.onPressArrowRight,\n        hideExtraDays: !horizontal,\n        renderArrow: this.renderArrow,\n        staticHeader: true,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 492,\n          columnNumber: 13\n        }\n      })), horizontal && this.renderWeekCalendar(), !hideKnob && this.renderKnob(), !horizontal && this.renderHeader()));\n    }\n  }]);\n\n  return ExpandableCalendar;\n}(Component);\n\nExpandableCalendar.displayName = 'ExpandableCalendar';\nExpandableCalendar.propTypes = _objectSpread(_objectSpread({}, CalendarList.propTypes), {}, {\n  initialPosition: PropTypes.oneOf(_.values(POSITIONS)),\n  onCalendarToggled: PropTypes.func,\n  disablePan: PropTypes.bool,\n  hideKnob: PropTypes.bool,\n  leftArrowImageSource: PropTypes.oneOfType([PropTypes.object, PropTypes.number, PropTypes.func]),\n  rightArrowImageSource: PropTypes.oneOfType([PropTypes.object, PropTypes.number, PropTypes.func]),\n  allowShadow: PropTypes.bool,\n  disableWeekScroll: PropTypes.bool,\n  openThreshold: PropTypes.number,\n  closeThreshold: PropTypes.number\n});\nExpandableCalendar.defaultProps = {\n  horizontal: true,\n  initialPosition: POSITIONS.CLOSED,\n  firstDay: 0,\n  leftArrowImageSource: require(\"../calendar/img/previous.png\"),\n  rightArrowImageSource: require(\"../calendar/img/next.png\"),\n  allowShadow: true,\n  openThreshold: PAN_GESTURE_THRESHOLD,\n  closeThreshold: PAN_GESTURE_THRESHOLD\n};\nExpandableCalendar.positions = POSITIONS;\nexport default asCalendarConsumer(ExpandableCalendar);","map":{"version":3,"sources":["/Users/kw/LocalDev/efficiently-app/node_modules/react-native-calendars/src/expandableCalendar/index.js"],"names":["_","PropTypes","memoize","XDate","React","Component","CALENDAR_KNOB","dateutils","parseDate","toMarkingFormat","styleConstructor","HEADER_HEIGHT","CalendarList","Calendar","asCalendarConsumer","WeekCalendar","Week","commons","require","UPDATE_SOURCES","POSITIONS","CLOSED","OPEN","SPEED","BOUNCINESS","CLOSED_HEIGHT","WEEK_HEIGHT","KNOB_CONTAINER_HEIGHT","DAY_NAMES_PADDING","PAN_GESTURE_THRESHOLD","ExpandableCalendar","props","handleScreenReaderStatus","screenReaderEnabled","setState","handleMoveShouldSetPanResponder","e","gestureState","disablePan","horizontal","state","position","dy","handlePanResponderGrant","handlePanResponderMove","_wrapperStyles","style","height","Math","max","closedHeight","_height","_headerStyles","top","min","_weekCalendarStyles","opacity","updateNativeStyles","handlePanResponderEnd","bounceToPosition","onAnimatedFinished","finished","onPressArrowLeft","invoke","scrollPage","onPressArrowRight","onDayPress","value","context","dateString","DAY_PRESS","setTimeout","onVisibleMonthsChange","visibleMonth","first","month","date","updateSource","getMonth","next","isLaterDate","numberOfWeeks","getNumberOfWeeksInMonth","openHeight","getOpenHeight","getWeekDaysStyle","calendarStyle","weekDayNames","paddingLeft","paddingRight","renderWeekDaysNames","weekDaysNames","map","day","index","weekday","renderArrow","direction","isFunction","rightArrowImageSource","leftArrowImageSource","arrowImage","testID","theme","hideKnob","startHeight","initialPosition","wrapper","undefined","calendar","initialDate","headerStyleOverride","week","marginTop","marginBottom","flexDirection","justifyContent","deltaY","Animated","Value","headerDeltaY","panResponder","PanResponder","create","onMoveShouldSetPanResponder","onPanResponderGrant","onPanResponderMove","onPanResponderRelease","onPanResponderTerminate","AccessibilityInfo","isScreenReaderEnabled","then","fetch","prevProps","scrollToDate","setNativeProps","header","weekCalendar","scrollToDay","scrollToMonth","d","setDate","addMonths","firstDay","dayOfTheWeek","getDay","firstDayOfWeek","addDays","PAGE_SCROLL","screenHeight","screenWidth","getFullYear","days","page","length","hideArrows","date1","date2","year","getYear","toValue","openThreshold","closeThreshold","threshold","isOpen","newValue","setValue","spring","speed","bounciness","useNativeDriver","start","setPosition","closeHeader","resetWeekCalendarOpacity","isClosed","monthYear","toString","headerTitle","disableWeekScroll","WeekComponent","weekContainer","hidden","visible","knobContainer","knob","allowShadow","others","themeObject","containerShadow","panHandlers","r","shouldHideArrows","renderWeekCalendar","renderKnob","renderHeader","displayName","propTypes","oneOf","values","onCalendarToggled","func","bool","oneOfType","object","number","defaultProps","positions"],"mappings":"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","sourcesContent":["import _ from 'lodash';\nimport PropTypes from 'prop-types';\nimport memoize from 'memoize-one';\nimport XDate from 'xdate';\n\nimport React, {Component} from 'react';\nimport {AccessibilityInfo, PanResponder, Animated, View, Text, Image} from 'react-native';\n\nimport {CALENDAR_KNOB} from '../testIDs';\nimport dateutils from '../dateutils';\nimport {parseDate, toMarkingFormat} from '../interface';\nimport styleConstructor, {HEADER_HEIGHT} from './style';\nimport CalendarList from '../calendar-list';\nimport Calendar from '../calendar';\nimport asCalendarConsumer from './asCalendarConsumer';\nimport WeekCalendar from './WeekCalendar';\nimport Week from './week';\n\nconst commons = require('./commons');\nconst UPDATE_SOURCES = commons.UPDATE_SOURCES;\nconst POSITIONS = {\n  CLOSED: 'closed',\n  OPEN: 'open'\n};\nconst SPEED = 20;\nconst BOUNCINESS = 6;\nconst CLOSED_HEIGHT = 120; // header + 1 week\nconst WEEK_HEIGHT = 46;\nconst KNOB_CONTAINER_HEIGHT = 20;\nconst DAY_NAMES_PADDING = 24;\nconst PAN_GESTURE_THRESHOLD = 30;\n\n/**\n * @description: Expandable calendar component\n * @note: Should be wrapped with 'CalendarProvider'\n * @extends: CalendarList\n * @extendslink: docs/CalendarList\n * @example: https://github.com/wix/react-native-calendars/blob/master/example/src/screens/expandableCalendar.js\n */\nclass ExpandableCalendar extends Component {\n  static displayName = 'ExpandableCalendar';\n\n  static propTypes = {\n    ...CalendarList.propTypes,\n    /** the initial position of the calendar ('open' or 'closed') */\n    initialPosition: PropTypes.oneOf(_.values(POSITIONS)),\n    /** callback that fires when the calendar is opened or closed */\n    onCalendarToggled: PropTypes.func,\n    /** an option to disable the pan gesture and disable the opening and closing of the calendar (initialPosition will persist)*/\n    disablePan: PropTypes.bool,\n    /** whether to hide the knob  */\n    hideKnob: PropTypes.bool,\n    /** source for the left arrow image */\n    leftArrowImageSource: PropTypes.oneOfType([PropTypes.object, PropTypes.number, PropTypes.func]),\n    /** source for the right arrow image */\n    rightArrowImageSource: PropTypes.oneOfType([PropTypes.object, PropTypes.number, PropTypes.func]),\n    /** whether to have shadow/elevation for the calendar */\n    allowShadow: PropTypes.bool,\n    /** whether to disable the week scroll in closed position */\n    disableWeekScroll: PropTypes.bool,\n    /** a threshold for opening the calendar with the pan gesture */\n    openThreshold: PropTypes.number,\n    /** a threshold for closing the calendar with the pan gesture */\n    closeThreshold: PropTypes.number\n  };\n\n  static defaultProps = {\n    horizontal: true,\n    initialPosition: POSITIONS.CLOSED,\n    firstDay: 0,\n    leftArrowImageSource: require('../calendar/img/previous.png'),\n    rightArrowImageSource: require('../calendar/img/next.png'),\n    allowShadow: true,\n    openThreshold: PAN_GESTURE_THRESHOLD,\n    closeThreshold: PAN_GESTURE_THRESHOLD\n  };\n\n  static positions = POSITIONS;\n\n  constructor(props) {\n    super(props);\n\n    this.style = styleConstructor(props.theme);\n    this.closedHeight = CLOSED_HEIGHT + (props.hideKnob ? 0 : KNOB_CONTAINER_HEIGHT);\n    this.numberOfWeeks = this.getNumberOfWeeksInMonth(XDate(this.props.context.date));\n    this.openHeight = this.getOpenHeight();\n\n    const startHeight = props.initialPosition === POSITIONS.CLOSED ? this.closedHeight : this.openHeight;\n    this._height = startHeight;\n    this._wrapperStyles = {style: {height: startHeight}};\n    this._headerStyles = {style: {top: props.initialPosition === POSITIONS.CLOSED ? 0 : -HEADER_HEIGHT}};\n    this._weekCalendarStyles = {style: {}};\n\n    this.wrapper = undefined;\n    this.calendar = undefined;\n    this.visibleMonth = this.getMonth(this.props.context.date);\n    this.initialDate = props.context.date; // should be set only once!!!\n    this.headerStyleOverride = {\n      'stylesheet.calendar.header': {\n        week: {\n          marginTop: 7,\n          marginBottom: -4, // reduce space between dayNames and first line of dates\n          flexDirection: 'row',\n          justifyContent: 'space-around'\n        }\n      }\n    };\n\n    this.state = {\n      deltaY: new Animated.Value(startHeight),\n      headerDeltaY: new Animated.Value(props.initialPosition === POSITIONS.CLOSED ? 0 : -HEADER_HEIGHT),\n      position: props.initialPosition,\n      screenReaderEnabled: false\n    };\n\n    this.panResponder = PanResponder.create({\n      onMoveShouldSetPanResponder: this.handleMoveShouldSetPanResponder,\n      onPanResponderGrant: this.handlePanResponderGrant,\n      onPanResponderMove: this.handlePanResponderMove,\n      onPanResponderRelease: this.handlePanResponderEnd,\n      onPanResponderTerminate: this.handlePanResponderEnd\n    });\n  }\n\n  componentDidMount() {\n    if (AccessibilityInfo) {\n      if (AccessibilityInfo.isScreenReaderEnabled) {\n        AccessibilityInfo.isScreenReaderEnabled().then(this.handleScreenReaderStatus);\n      } else if (AccessibilityInfo.fetch) {\n        // Support for older RN versions\n        AccessibilityInfo.fetch().then(this.handleScreenReaderStatus);\n      }\n    }\n  }\n\n  componentDidUpdate(prevProps) {\n    const {date} = this.props.context;\n    if (date !== prevProps.context.date) {\n      // date was changed from AgendaList, arrows or scroll\n      this.scrollToDate(date);\n    }\n  }\n\n  handleScreenReaderStatus = screenReaderEnabled => {\n    this.setState({screenReaderEnabled});\n  };\n\n  updateNativeStyles() {\n    this.wrapper?.setNativeProps(this._wrapperStyles);\n    if (!this.props.horizontal) {\n      this.header && this.header.setNativeProps(this._headerStyles);\n    } else {\n      this.weekCalendar && this.weekCalendar.setNativeProps(this._weekCalendarStyles);\n    }\n  }\n\n  /** Scroll */\n\n  scrollToDate(date) {\n    if (this.calendar) {\n      if (!this.props.horizontal) {\n        this.calendar.scrollToDay(XDate(date), 0, true);\n      } else if (this.getMonth(date) !== this.visibleMonth) {\n        // don't scroll if the month is already visible\n        this.calendar.scrollToMonth(XDate(date));\n      }\n    }\n  }\n\n  scrollPage(next) {\n    if (this.props.horizontal) {\n      const d = parseDate(this.props.context.date);\n\n      if (this.state.position === POSITIONS.OPEN) {\n        d.setDate(1);\n        d.addMonths(next ? 1 : -1);\n      } else {\n        const {firstDay} = this.props;\n        let dayOfTheWeek = d.getDay();\n        if (dayOfTheWeek < firstDay && firstDay > 0) {\n          dayOfTheWeek = 7 + dayOfTheWeek;\n        }\n        const firstDayOfWeek = (next ? 7 : -7) - dayOfTheWeek + firstDay;\n        d.addDays(firstDayOfWeek);\n      }\n      _.invoke(this.props.context, 'setDate', toMarkingFormat(d), UPDATE_SOURCES.PAGE_SCROLL);\n    }\n  }\n\n  /** Utils */\n  getOpenHeight() {\n    if (!this.props.horizontal) {\n      return Math.max(commons.screenHeight, commons.screenWidth);\n    }\n    return CLOSED_HEIGHT + WEEK_HEIGHT * (this.numberOfWeeks - 1) + (this.props.hideKnob ? 12 : KNOB_CONTAINER_HEIGHT);\n  }\n\n  getYear(date) {\n    const d = XDate(date);\n    return d.getFullYear();\n  }\n\n  getMonth(date) {\n    const d = XDate(date);\n    // getMonth() returns the month of the year (0-11). Value is zero-index, meaning Jan=0, Feb=1, Mar=2, etc.\n    return d.getMonth() + 1;\n  }\n\n  getNumberOfWeeksInMonth(month) {\n    const days = dateutils.page(month, this.props.firstDay);\n    return days.length / 7;\n  }\n\n  shouldHideArrows() {\n    if (!this.props.horizontal) {\n      return true;\n    }\n    return this.props.hideArrows || false;\n  }\n\n  isLaterDate(date1, date2) {\n    if (date1.year > this.getYear(date2)) {\n      return true;\n    }\n    if (date1.year === this.getYear(date2)) {\n      if (date1.month > this.getMonth(date2)) {\n        return true;\n      }\n    }\n    return false;\n  }\n\n  /** Pan Gesture */\n\n  handleMoveShouldSetPanResponder = (e, gestureState) => {\n    if (this.props.disablePan) {\n      return false;\n    }\n    if (!this.props.horizontal && this.state.position === POSITIONS.OPEN) {\n      // disable pan detection when vertical calendar is open to allow calendar scroll\n      return false;\n    }\n    if (this.state.position === POSITIONS.CLOSED && gestureState.dy < 0) {\n      // disable pan detection to limit to closed height\n      return false;\n    }\n    return gestureState.dy > 5 || gestureState.dy < -5;\n  };\n  handlePanResponderGrant = () => {};\n  handlePanResponderMove = (e, gestureState) => {\n    // limit min height to closed height\n    this._wrapperStyles.style.height = Math.max(this.closedHeight, this._height + gestureState.dy);\n\n    if (!this.props.horizontal) {\n      // vertical CalenderList header\n      this._headerStyles.style.top = Math.min(Math.max(-gestureState.dy, -HEADER_HEIGHT), 0);\n    } else {\n      // horizontal Week view\n      if (this.state.position === POSITIONS.CLOSED) {\n        this._weekCalendarStyles.style.opacity = Math.min(1, Math.max(1 - gestureState.dy / 100, 0));\n      }\n    }\n\n    this.updateNativeStyles();\n  };\n  handlePanResponderEnd = () => {\n    this._height = this._wrapperStyles.style.height;\n    this.bounceToPosition();\n  };\n\n  /** Animated */\n\n  bounceToPosition(toValue) {\n    if (!this.props.disablePan) {\n      const {deltaY, position} = this.state;\n      const {openThreshold, closeThreshold} = this.props;\n      const threshold =\n        position === POSITIONS.OPEN ? this.openHeight - closeThreshold : this.closedHeight + openThreshold;\n\n      let isOpen = this._height >= threshold;\n      const newValue = isOpen ? this.openHeight : this.closedHeight;\n\n      deltaY.setValue(this._height); // set the start position for the animated value\n      this._height = toValue || newValue;\n      isOpen = this._height >= threshold; // re-check after this._height was set\n\n      Animated.spring(deltaY, {\n        toValue: this._height,\n        speed: SPEED,\n        bounciness: BOUNCINESS,\n        useNativeDriver: false\n      }).start(this.onAnimatedFinished);\n\n      _.invoke(this.props, 'onCalendarToggled', isOpen);\n\n      this.setPosition();\n      this.closeHeader(isOpen);\n      this.resetWeekCalendarOpacity(isOpen);\n    }\n  }\n\n  onAnimatedFinished = ({finished}) => {\n    if (finished) {\n      // this.setPosition();\n    }\n  };\n\n  setPosition() {\n    const isClosed = this._height === this.closedHeight;\n    this.setState({position: isClosed ? POSITIONS.CLOSED : POSITIONS.OPEN});\n  }\n\n  resetWeekCalendarOpacity(isOpen) {\n    this._weekCalendarStyles.style.opacity = isOpen ? 0 : 1;\n    this.updateNativeStyles();\n  }\n\n  closeHeader(isOpen) {\n    const {headerDeltaY} = this.state;\n\n    headerDeltaY.setValue(this._headerStyles.style.top); // set the start position for the animated value\n\n    if (!this.props.horizontal && !isOpen) {\n      Animated.spring(headerDeltaY, {\n        toValue: 0,\n        speed: SPEED / 10,\n        bounciness: 1,\n        useNativeDriver: false\n      }).start();\n    }\n  }\n\n  /** Events */\n\n  onPressArrowLeft = () => {\n    _.invoke(this.props, 'onPressArrowLeft');\n    this.scrollPage(false);\n  };\n\n  onPressArrowRight = () => {\n    _.invoke(this.props, 'onPressArrowRight');\n    this.scrollPage(true);\n  };\n\n  onDayPress = value => {\n    // {year: 2019, month: 4, day: 22, timestamp: 1555977600000, dateString: \"2019-04-23\"}\n    _.invoke(this.props.context, 'setDate', value.dateString, UPDATE_SOURCES.DAY_PRESS);\n\n    setTimeout(() => {\n      // to allows setDate to be completed\n      if (this.state.position === POSITIONS.OPEN) {\n        this.bounceToPosition(this.closedHeight);\n      }\n    }, 0);\n  };\n\n  onVisibleMonthsChange = value => {\n    if (this.visibleMonth !== _.first(value).month) {\n      this.visibleMonth = _.first(value).month; // equivalent to this.getMonth(value[0].dateString)\n\n      // for horizontal scroll\n      const {date, updateSource} = this.props.context;\n\n      if (this.visibleMonth !== this.getMonth(date) && updateSource !== UPDATE_SOURCES.DAY_PRESS) {\n        const next = this.isLaterDate(_.first(value), date);\n        this.scrollPage(next);\n      }\n\n      // updating openHeight\n      setTimeout(() => {\n        // to wait for setDate() call in horizontal scroll (this.scrollPage())\n        const numberOfWeeks = this.getNumberOfWeeksInMonth(parseDate(this.props.context.date));\n        if (numberOfWeeks !== this.numberOfWeeks) {\n          this.numberOfWeeks = numberOfWeeks;\n          this.openHeight = this.getOpenHeight();\n          if (this.state.position === POSITIONS.OPEN) {\n            this.bounceToPosition(this.openHeight);\n          }\n        }\n      }, 0);\n    }\n  };\n\n  /** Renders */\n  getWeekDaysStyle = memoize(calendarStyle => {\n    return [\n      this.style.weekDayNames,\n      {\n        paddingLeft: calendarStyle?.paddingLeft + 6 || DAY_NAMES_PADDING,\n        paddingRight: calendarStyle?.paddingRight + 6 || DAY_NAMES_PADDING\n      }\n    ];\n  });\n\n  renderWeekDaysNames = memoize((weekDaysNames, calendarStyle) => {\n    return (\n      <View style={this.getWeekDaysStyle(calendarStyle)}>\n        {weekDaysNames.map((day, index) => (\n          <Text allowFontScaling={false} key={day + index} style={this.style.weekday} numberOfLines={1}>\n            {day}\n          </Text>\n        ))}\n      </View>\n    );\n  });\n\n  renderHeader() {\n    const monthYear = XDate(this.props.context.date).toString('MMMM yyyy');\n    const weekDaysNames = dateutils.weekDayNames(this.props.firstDay);\n\n    return (\n      <Animated.View\n        ref={e => (this.header = e)}\n        style={[this.style.header, {height: HEADER_HEIGHT, top: this.state.headerDeltaY}]}\n        pointerEvents={'none'}\n      >\n        <Text allowFontScaling={false} style={this.style.headerTitle}>\n          {monthYear}\n        </Text>\n        {this.renderWeekDaysNames(weekDaysNames, this.props.calendarStyle)}\n      </Animated.View>\n    );\n  }\n\n  renderWeekCalendar() {\n    const {position} = this.state;\n    const {disableWeekScroll} = this.props;\n    const WeekComponent = disableWeekScroll ? Week : WeekCalendar;\n\n    return (\n      <Animated.View\n        ref={e => (this.weekCalendar = e)}\n        style={[this.style.weekContainer, position === POSITIONS.OPEN ? this.style.hidden : this.style.visible]}\n        pointerEvents={position === POSITIONS.CLOSED ? 'auto' : 'none'}\n      >\n        <WeekComponent\n          {...this.props}\n          current={this.props.context.date}\n          onDayPress={this.onDayPress}\n          style={this.props.calendarStyle}\n          allowShadow={false}\n          hideDayNames={true}\n          accessibilityElementsHidden // iOS\n          importantForAccessibility={'no-hide-descendants'} // Android\n        />\n      </Animated.View>\n    );\n  }\n\n  renderKnob() {\n    // TODO: turn to TouchableOpacity with onPress that closes it\n    return (\n      <View style={this.style.knobContainer} pointerEvents={'none'} testID={`${this.props.testID}-knob`}>\n        <View style={this.style.knob} testID={CALENDAR_KNOB} />\n      </View>\n    );\n  }\n\n  renderArrow = direction => {\n    if (_.isFunction(this.props.renderArrow)) {\n      return this.props.renderArrow(direction);\n    }\n\n    return (\n      <Image\n        source={direction === 'right' ? this.props.rightArrowImageSource : this.props.leftArrowImageSource}\n        style={this.style.arrowImage}\n        testID={`${this.props.testID}-${direction}-arrow`}\n      />\n    );\n  };\n\n  render() {\n    const {style, hideKnob, horizontal, allowShadow, theme, ...others} = this.props;\n    const {deltaY, position, screenReaderEnabled} = this.state;\n    const isOpen = position === POSITIONS.OPEN;\n    const themeObject = Object.assign(this.headerStyleOverride, theme);\n\n    return (\n      <View testID={this.props.testID} style={[allowShadow && this.style.containerShadow, style]}>\n        {screenReaderEnabled ? (\n          <Calendar\n            testID=\"calendar\"\n            {...others}\n            theme={themeObject}\n            onDayPress={this.onDayPress}\n            hideExtraDays\n            renderArrow={this.renderArrow}\n          />\n        ) : (\n          <Animated.View ref={e => (this.wrapper = e)} style={{height: deltaY}} {...this.panResponder.panHandlers}>\n            <CalendarList\n              testID=\"calendar\"\n              horizontal={horizontal}\n              {...others}\n              theme={themeObject}\n              ref={r => (this.calendar = r)}\n              current={this.initialDate}\n              onDayPress={this.onDayPress}\n              onVisibleMonthsChange={this.onVisibleMonthsChange}\n              pagingEnabled\n              scrollEnabled={isOpen}\n              hideArrows={this.shouldHideArrows()}\n              onPressArrowLeft={this.onPressArrowLeft}\n              onPressArrowRight={this.onPressArrowRight}\n              hideExtraDays={!horizontal}\n              renderArrow={this.renderArrow}\n              staticHeader\n            />\n            {horizontal && this.renderWeekCalendar()}\n            {!hideKnob && this.renderKnob()}\n            {!horizontal && this.renderHeader()}\n          </Animated.View>\n        )}\n      </View>\n    );\n  }\n}\n\nexport default asCalendarConsumer(ExpandableCalendar);\n"]},"metadata":{},"sourceType":"module"}